R1.1 2016-01-07: Rewrite to make more general
